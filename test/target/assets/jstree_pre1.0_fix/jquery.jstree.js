"use strict";!function(){if(!jQuery||!jQuery.jstree){var is_ie6=!1,is_ie7=!1,is_ff2=!1;!function($){$.vakata={},$.vakata.css={get_css:function(rule_name,delete_flag,sheet){rule_name=rule_name.toLowerCase();var css_rules=sheet.cssRules||sheet.rules,j=0;do{if(css_rules.length&&j>css_rules.length+5)return!1;if(css_rules[j].selectorText&&css_rules[j].selectorText.toLowerCase()==rule_name)return delete_flag===!0?(sheet.removeRule&&sheet.removeRule(j),sheet.deleteRule&&sheet.deleteRule(j),!0):css_rules[j]}while(css_rules[++j]);return!1},add_css:function(rule_name,sheet){return $.jstree.css.get_css(rule_name,!1,sheet)?!1:(sheet.insertRule?sheet.insertRule(rule_name+" { }",0):sheet.addRule(rule_name,null,0),$.vakata.css.get_css(rule_name))},remove_css:function(rule_name,sheet){return $.vakata.css.get_css(rule_name,!0,sheet)},add_sheet:function(opts){var tmp=!1,is_new=!0;if(opts.str)return opts.title&&(tmp=$("style[id='"+opts.title+"-stylesheet']")[0]),tmp?is_new=!1:(tmp=document.createElement("style"),tmp.setAttribute("type","text/css"),opts.title&&tmp.setAttribute("id",opts.title+"-stylesheet")),tmp.styleSheet?is_new?(document.getElementsByTagName("head")[0].appendChild(tmp),tmp.styleSheet.cssText=opts.str):tmp.styleSheet.cssText=tmp.styleSheet.cssText+" "+opts.str:(tmp.appendChild(document.createTextNode(opts.str)),document.getElementsByTagName("head")[0].appendChild(tmp)),tmp.sheet||tmp.styleSheet;if(opts.url){if(!document.createStyleSheet)return tmp=document.createElement("link"),tmp.rel="stylesheet",tmp.type="text/css",tmp.media="all",tmp.href=opts.url,document.getElementsByTagName("head")[0].appendChild(tmp),tmp.styleSheet;try{tmp=document.createStyleSheet(opts.url)}catch(e){}}}};var instances=[],focused_instance=-1,plugins={},prepared_move={};$.fn.jstree=function(settings){var isMethodCall="string"==typeof settings,args=Array.prototype.slice.call(arguments,1),returnValue=this;if(isMethodCall){if("_"==settings.substring(0,1))return returnValue;this.each(function(){var instance=instances[$.data(this,"jstree_instance_id")],methodValue=instance&&$.isFunction(instance[settings])?instance[settings].apply(instance,args):instance;return"undefined"!=typeof methodValue&&(0===settings.indexOf("is_")||methodValue!==!0&&methodValue!==!1)?(returnValue=methodValue,!1):void 0})}else this.each(function(){var instance_id=$.data(this,"jstree_instance_id"),a=[],b=settings?$.extend({},!0,settings):{},c=$(this),s=!1,t=[];a=a.concat(args),c.data("jstree")&&a.push(c.data("jstree")),b=a.length?$.extend.apply(null,[!0,b].concat(a)):b,"undefined"!=typeof instance_id&&instances[instance_id]&&instances[instance_id].destroy(),instance_id=parseInt(instances.push({}),10)-1,$.data(this,"jstree_instance_id",instance_id),b.plugins=$.isArray(b.plugins)?b.plugins:$.jstree.defaults.plugins.slice(),b.plugins.unshift("core"),b.plugins=b.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),s=$.extend(!0,{},$.jstree.defaults,b),s.plugins=b.plugins,$.each(plugins,function(i){-1===$.inArray(i,s.plugins)?(s[i]=null,delete s[i]):t.push(i)}),s.plugins=t,instances[instance_id]=new $.jstree._instance(instance_id,$(this).addClass("jstree jstree-"+instance_id),s),$.each(instances[instance_id]._get_settings().plugins,function(i,val){instances[instance_id].data[val]={}}),$.each(instances[instance_id]._get_settings().plugins,function(i,val){plugins[val]&&plugins[val].__init.apply(instances[instance_id])}),setTimeout(function(){instances[instance_id]&&instances[instance_id].init()},0)});return returnValue},$.jstree={defaults:{plugins:[]},_focused:function(){return instances[focused_instance]||null},_reference:function(needle){if(instances[needle])return instances[needle];var o=$(needle);return o.length||"string"!=typeof needle||(o=$("#"+needle)),o.length?instances[o.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(index,container,settings){this.data={core:{}},this.get_settings=function(){return $.extend(!0,{},settings)},this._get_settings=function(){return settings},this.get_index=function(){return index},this.get_container=function(){return container},this.get_container_ul=function(){return container.children("ul:eq(0)")},this._set_settings=function(s){settings=$.extend(!0,{},settings,s)}},_fn:{},plugin:function(pname,pdata){pdata=$.extend({},{__init:$.noop,__destroy:$.noop,_fn:{},defaults:!1},pdata),plugins[pname]=pdata,$.jstree.defaults[pname]=pdata.defaults,$.each(pdata._fn,function(i,val){val.plugin=pname,val.old=$.jstree._fn[i],$.jstree._fn[i]=function(){var rslt,func=val,args=Array.prototype.slice.call(arguments),evnt=new $.Event("before.jstree"),rlbk=!1;if(this.data.core.locked!==!0||"unlock"===i||"is_locked"===i){do{if(func&&func.plugin&&-1!==$.inArray(func.plugin,this._get_settings().plugins))break;func=func.old}while(func);if(func){if(0===i.indexOf("_"))rslt=func.apply(this,args);else{if(rslt=this.get_container().triggerHandler(evnt,{func:i,inst:this,args:args,plugin:func.plugin}),rslt===!1)return;"undefined"!=typeof rslt&&(args=rslt),rslt=func.apply($.extend({},this,{__callback:function(data){this.get_container().triggerHandler(i+".jstree",{inst:this,args:args,rslt:data,rlbk:rlbk})},__rollback:function(){return rlbk=this.get_rollback()},__call_old:function(replace_arguments){return func.old.apply(this,replace_arguments?Array.prototype.slice.call(arguments,1):args)}}),args)}return rslt}}},$.jstree._fn[i].old=val.old,$.jstree._fn[i].plugin=pname})},rollback:function(rb){rb&&($.isArray(rb)||(rb=[rb]),$.each(rb,function(i,val){instances[val.i].set_rollback(val.h,val.d)}))}},$.jstree._fn=$.jstree._instance.prototype={},$(function(){var u=navigator.userAgent.toLowerCase(),v=(u.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],css_string=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(u)&&6==parseInt(v,10)){is_ie6=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(err){}css_string+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(u)&&7==parseInt(v,10)&&(is_ie7=!0,css_string+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(u)&&/mozilla/.test(u)&&parseFloat(v,10)<1.9&&(is_ff2=!0,css_string+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),$.vakata.css.add_sheet({str:css_string,title:"jstree"})}),$.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",$.proxy(function(event){var trgt=$(event.target);this.toggle_node(trgt)},this)).bind("mousedown.jstree",$.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var sel;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){sel=window.getSelection();try{sel.removeAllRanges(),sel.collapse()}catch(err){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;-1===o&&(o=this.get_container_ul()),o.length&&o.find("li").each(function(){var th=$(this);th.data("jstree")&&$.each(th.data("jstree"),function(plugin,values){t.data[plugin]&&$.isFunction(t["_"+plugin+"_notify"])&&t["_"+plugin+"_notify"].call(t,th,values)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var o=this._get_node(data.rslt.obj),t=this;-1===o&&(o=this.get_container_ul()),o.length&&o.find("li.jstree-open:not(:has(ul))").each(function(){t.load_node(this,$.noop,$.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var i,n=this.get_index(),s=this._get_settings(),_this=this;if($.each(s.plugins,function(i,val){try{plugins[val].__destroy.apply(_this)}catch(err){}}),this.__callback(),this.is_focused())for(i in instances)if(instances.hasOwnProperty(i)&&i!=n){instances[i].set_focus();break}n===focused_instance&&(focused_instance=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),$(document).unbind(".jstree-"+n).undelegate(".jstree-"+n),instances[n]=null,delete instances[n]},_core_notify:function(n,data){data.opened&&this.open_node(n,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var _this=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&_this.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(_this.data.core.to_open)},save_loaded:function(){},reload_nodes:function(is_callback){var _this=this,done=!0,current=[],remaining=[];is_callback||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=$.map($.makeArray(this.data.core.to_open),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=$.map($.makeArray(this.data.core.to_load),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&($.each(this.data.core.to_load,function(i,val){return"#"==val?!0:void($(val).length?current.push(val):remaining.push(val))}),current.length&&(this.data.core.to_load=remaining,$.each(current,function(i,val){_this._is_loaded(val)||(_this.load_node(val,function(){_this.reload_nodes(!0)},function(){_this.reload_nodes(!0)}),done=!1)}))),this.data.core.to_open.length&&$.each(this.data.core.to_open,function(i,val){_this.open_node(val,!1,!0)}),done&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){_this.__callback({},_this)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var _this=this;this.data.core.to_open.length&&$.each(this.data.core.to_open,function(i,val){_this.open_node(val,!1,!0)}),this.__callback({})},refresh:function(obj){var _this=this;this.save_opened(),obj||(obj=-1),obj=this._get_node(obj),obj||(obj=-1),-1!==obj?obj.children("UL").remove():this.get_container_ul().empty(),this.load_node(obj,function(){_this.__callback({obj:obj}),_this.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var f=$.jstree._focused();f&&f.unset_focus(),this.get_container().addClass("jstree-focused"),focused_instance=this.get_index(),this.__callback()}},is_focused:function(){return focused_instance==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),focused_instance=-1),this.__callback()},_get_node:function(obj){var $obj=$(obj,this.get_container());return $obj.is(".jstree")||-1==obj?-1:($obj=$obj.closest("li",this.get_container()),$obj.length?$obj:!1)},_get_next:function(obj,strict){return obj=this._get_node(obj),-1===obj?this.get_container().find("> ul > li:first-child"):obj.length?strict?obj.nextAll("li").size()>0?obj.nextAll("li:eq(0)"):!1:obj.hasClass("jstree-open")?obj.find("li:eq(0)"):obj.nextAll("li").size()>0?obj.nextAll("li:eq(0)"):obj.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(obj,strict){if(obj=this._get_node(obj),-1===obj)return this.get_container().find("> ul > li:last-child");if(!obj.length)return!1;if(strict)return obj.prevAll("li").length>0?obj.prevAll("li:eq(0)"):!1;if(obj.prev("li").length){for(obj=obj.prev("li").eq(0);obj.hasClass("jstree-open");)obj=obj.children("ul:eq(0)").children("li:last");return obj}var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:!1},_get_parent:function(obj){if(obj=this._get_node(obj),-1==obj||!obj.length)return!1;var o=obj.parentsUntil(".jstree","li:eq(0)");return o.length?o:-1},_get_children:function(obj){return obj=this._get_node(obj),-1===obj?this.get_container().children("ul:eq(0)").children("li"):obj.length?obj.children("ul:eq(0)").children("li"):!1},get_path:function(obj,id_mode){var p=[],_this=this;return obj=this._get_node(obj),-1!==obj&&obj&&obj.length?(obj.parentsUntil(".jstree","li").each(function(){p.push(id_mode?this.id:_this.get_text(this))}),p.reverse(),p.push(id_mode?obj.attr("id"):this.get_text(obj)),p):!1},_get_string:function(key){return this._get_settings().core.strings[key]||key},is_open:function(obj){return obj=this._get_node(obj),obj&&-1!==obj&&obj.hasClass("jstree-open")},is_closed:function(obj){return obj=this._get_node(obj),obj&&-1!==obj&&obj.hasClass("jstree-closed")},is_leaf:function(obj){return obj=this._get_node(obj),obj&&-1!==obj&&obj.hasClass("jstree-leaf")},correct_state:function(obj){return obj=this._get_node(obj),obj&&-1!==obj?(obj.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),void this.__callback({obj:obj})):!1},open_node:function(obj,callback,skip_animation){if(obj=this._get_node(obj),!obj.length)return!1;if(!obj.hasClass("jstree-closed"))return callback&&callback.call(),!1;var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;this._is_loaded(obj)?(this._get_settings().core.open_parents&&obj.parentsUntil(".jstree",".jstree-closed").each(function(){t.open_node(this,!1,!0)}),s&&obj.children("ul").css("display","none"),obj.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),s?obj.children("ul").stop(!0,!0).slideDown(s,function(){this.style.display="",t.after_open(obj)}):t.after_open(obj),this.__callback({obj:obj}),callback&&callback.call()):(obj.children("a").addClass("jstree-loading"),this.load_node(obj,function(){t.open_node(obj,callback,skip_animation)},callback))},after_open:function(obj){this.__callback({obj:obj})},close_node:function(obj,skip_animation){obj=this._get_node(obj);var s=skip_animation||is_ie6?0:this._get_settings().core.animation,t=this;return obj.length&&obj.hasClass("jstree-open")?(s&&obj.children("ul").attr("style","display:block !important"),obj.removeClass("jstree-open").addClass("jstree-closed"),s?obj.children("ul").stop(!0,!0).slideUp(s,function(){this.style.display="",t.after_close(obj)}):t.after_close(obj),void this.__callback({obj:obj})):!1},after_close:function(obj){this.__callback({obj:obj})},toggle_node:function(obj){return obj=this._get_node(obj),obj.hasClass("jstree-closed")?this.open_node(obj):obj.hasClass("jstree-open")?this.close_node(obj):void 0},open_all:function(obj,do_animation,original_obj){obj=obj?this._get_node(obj):-1,obj&&-1!==obj||(obj=this.get_container_ul()),original_obj?obj=obj.find("li.jstree-closed"):(original_obj=obj,obj=obj.is(".jstree-closed")?obj.find("li.jstree-closed").andSelf():obj.find("li.jstree-closed"));var _this=this;obj.each(function(){var __this=this;_this._is_loaded(this)?_this.open_node(this,!1,!do_animation):_this.open_node(this,function(){_this.open_all(__this,do_animation,original_obj)},!do_animation)}),0===original_obj.find("li.jstree-closed").length&&this.__callback({obj:original_obj})},close_all:function(obj,do_animation){var _this=this;obj=obj?this._get_node(obj):this.get_container(),obj&&-1!==obj||(obj=this.get_container_ul()),obj.find("li.jstree-open").andSelf().each(function(){_this.close_node(this,!do_animation)}),this.__callback({obj:obj})},clean_node:function(obj){obj=obj&&-1!=obj?$(obj):this.get_container_ul(),obj=obj.is("li")?obj.find("li").andSelf():obj.find("li"),obj.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),obj.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:obj})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(html,data){this.get_container().empty().append(html),this.data=data,this.__callback()},load_node:function(obj){this.__callback({obj:obj})},_is_loaded:function(){return!0},create_node:function(obj,position,js,callback,is_loaded){obj=this._get_node(obj),position="undefined"==typeof position?"last":position;var tmp,d=$("<li />"),s=this._get_settings().core;if(-1!==obj&&!obj.length)return!1;if(!is_loaded&&!this._is_loaded(obj))return this.load_node(obj,function(){this.create_node(obj,position,js,callback,!0)}),!1;switch(this.__rollback(),"string"==typeof js&&(js={data:js}),js||(js={}),js.attr&&d.attr(js.attr),js.metadata&&d.data(js.metadata),js.state&&d.addClass("jstree-"+js.state),js.data||(js.data=this._get_string("new_node")),$.isArray(js.data)||(tmp=js.data,js.data=[],js.data.push(tmp)),$.each(js.data,function(i,m){tmp=$("<a />"),$.isFunction(m)&&(m=m.call(this,js)),"string"==typeof m?tmp.attr("href","#")[s.html_titles?"html":"text"](m):(m.attr||(m.attr={}),m.attr.href||(m.attr.href="#"),tmp.attr(m.attr)[s.html_titles?"html":"text"](m.title),m.language&&tmp.addClass(m.language)),tmp.prepend("<ins class='jstree-icon'>&#160;</ins>"),!m.icon&&js.icon&&(m.icon=js.icon),m.icon&&(-1===m.icon.indexOf("/")?tmp.children("ins").addClass(m.icon):tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat")),d.append(tmp)}),d.prepend("<ins class='jstree-icon'>&#160;</ins>"),-1===obj&&(obj=this.get_container(),"before"===position&&(position="first"),"after"===position&&(position="last")),position){case"before":obj.before(d),tmp=this._get_parent(obj);break;case"after":obj.after(d),tmp=this._get_parent(obj);break;case"inside":case"first":obj.children("ul").length||obj.append("<ul />"),obj.children("ul").prepend(d),tmp=obj;break;case"last":obj.children("ul").length||obj.append("<ul />"),obj.children("ul").append(d),tmp=obj;break;default:obj.children("ul").length||obj.append("<ul />"),position||(position=0),tmp=obj.children("ul").children("li").eq(position),tmp.length?tmp.before(d):obj.children("ul").append(d),tmp=obj}return(-1===tmp||tmp.get(0)===this.get_container().get(0))&&(tmp=-1),this.clean_node(tmp),this.__callback({obj:d,parent:tmp}),callback&&callback.call(this,d),d},get_text:function(obj){if(obj=this._get_node(obj),!obj.length)return!1;var s=this._get_settings().core.html_titles;return obj=obj.children("a:eq(0)"),s?(obj=obj.clone(),obj.children("INS").remove(),obj.html()):(obj=obj.contents().filter(function(){return 3==this.nodeType})[0],obj.nodeValue)},set_text:function(obj,val){if(obj=this._get_node(obj),!obj.length)return!1;if(obj=obj.children("a:eq(0)"),this._get_settings().core.html_titles){var tmp=obj.children("INS").clone();return obj.html(val).prepend(tmp),this.__callback({obj:obj,name:val}),!0}return obj=obj.contents().filter(function(){return 3==this.nodeType})[0],this.__callback({obj:obj,name:val}),obj.nodeValue=val},rename_node:function(obj,val){obj=this._get_node(obj),this.__rollback(),obj&&obj.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:obj,name:val})},delete_node:function(obj){if(obj=this._get_node(obj),!obj.length)return!1;this.__rollback();var p=this._get_parent(obj),prev=$([]),t=this;return obj.each(function(){prev=prev.add(t._get_prev(this))}),obj=obj.detach(),-1!==p&&0===p.find("> ul > li").length&&p.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(p),this.__callback({obj:obj,prev:prev,parent:p}),obj},prepare_move:function(o,r,pos,cb,is_cb){var p={};if(p.ot=$.jstree._reference(o)||this,p.o=p.ot._get_node(o),p.r=-1===r?-1:this._get_node(r),p.p="undefined"==typeof pos||pos===!1?"last":pos,!is_cb&&prepared_move.o&&prepared_move.o[0]===p.o[0]&&prepared_move.r[0]===p.r[0]&&prepared_move.p===p.p)return this.__callback(prepared_move),void(cb&&cb.call(this,prepared_move));if(p.ot=$.jstree._reference(p.o)||this,p.rt=$.jstree._reference(p.r)||this,-1!==p.r&&p.r){if(!/^(before|after)$/.test(p.p)&&!this._is_loaded(p.r))return this.load_node(p.r,function(){this.prepare_move(o,r,pos,cb,!0)});switch(p.p){case"before":p.cp=p.r.index(),p.cr=p.rt._get_parent(p.r);break;case"after":p.cp=p.r.index()+1,p.cr=p.rt._get_parent(p.r);break;case"inside":case"first":p.cp=0,p.cr=p.r;break;case"last":p.cp=p.r.find(" > ul > li").length,p.cr=p.r;break;default:p.cp=p.p,p.cr=p.r}}else switch(p.cr=-1,p.p){case"first":case"before":case"inside":p.cp=0;break;case"after":case"last":p.cp=p.rt.get_container().find(" > ul > li").length;break;default:p.cp=p.p}p.np=-1==p.cr?p.rt.get_container():p.cr,p.op=p.ot._get_parent(p.o),p.cop=p.o.index(),-1===p.op&&(p.op=p.ot?p.ot.get_container():this.get_container()),!/^(before|after)$/.test(p.p)&&p.op&&p.np&&p.op[0]===p.np[0]&&p.o.index()<p.cp&&p.cp++,p.or=p.np.find(" > ul > li:nth-child("+(p.cp+1)+")"),prepared_move=p,this.__callback(prepared_move),cb&&cb.call(this,prepared_move)},check_move:function(){var obj=prepared_move,ret=!0,r=-1===obj.r?this.get_container():obj.r;return obj&&obj.o&&obj.or[0]!==obj.o[0]?obj.op&&obj.np&&obj.op[0]===obj.np[0]&&obj.cp-1===obj.o.index()?!1:(obj.o.each(function(){return-1!==r.parentsUntil(".jstree","li").andSelf().index(this)?(ret=!1,!1):void 0}),ret):!1},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){if(!is_prepared)return this.prepare_move(obj,ref,position,function(p){this.move_node(p,!1,!1,is_copy,!0,skip_check)});if(is_copy&&(prepared_move.cy=!0),!skip_check&&!this.check_move())return!1;this.__rollback();var o=!1;is_copy?(o=obj.o.clone(!0),o.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):o=obj.o,obj.or.length?obj.or.before(o):(obj.np.children("ul").length||$("<ul />").appendTo(obj.np),obj.np.children("ul:eq(0)").append(o));try{obj.ot.clean_node(obj.op),obj.rt.clean_node(obj.np),obj.op.find("> ul > li").length||obj.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(e){}return is_copy&&(prepared_move.cy=!0,prepared_move.oc=o),this.__callback(prepared_move),prepared_move},_get_move:function(){return prepared_move}}})}(jQuery),function($){var scrollbar_width,e1,e2;$(function(){/msie/.test(navigator.userAgent.toLowerCase())?(e1=$('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),e2=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),scrollbar_width=e1.width()-e2.width(),e1.add(e2).remove()):(e1=$("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),scrollbar_width=100-e1.width(),e1.parent().remove())}),$.jstree.plugin("ui",{__init:function(){this.data.ui.selected=$(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",$.proxy(function(event){event.preventDefault(),event.currentTarget.blur(),$(event.currentTarget).hasClass("jstree-loading")||this.select_node(event.currentTarget,!0,event)},this)).delegate("a","mouseenter.jstree",$.proxy(function(event){$(event.currentTarget).hasClass("jstree-loading")||this.hover_node(event.target)},this)).delegate("a","mouseleave.jstree",$.proxy(function(event){$(event.currentTarget).hasClass("jstree-loading")||this.dehover_node(event.target)},this)).bind("reopen.jstree",$.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",$.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",$.proxy(function(){this.reselect()},this)).bind("close_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui,obj=this._get_node(data.rslt.obj),clk=obj&&obj.length?obj.children("ul").find("a.jstree-clicked"):$(),_this=this;s.selected_parent_close!==!1&&clk.length&&clk.each(function(){_this.deselect_node(this),"select_parent"===s.selected_parent_close&&_this.select_node(obj)})},this)).bind("delete_node.jstree",$.proxy(function(event,data){var s=this._get_settings().ui.select_prev_on_delete,obj=this._get_node(data.rslt.obj),clk=obj&&obj.length?obj.find("a.jstree-clicked"):[],_this=this;clk.each(function(){_this.deselect_node(this)}),s&&clk.length&&data.rslt.prev.each(function(){return this.parentNode?(_this.select_node(this),!1):void 0})},this)).bind("move_node.jstree",$.proxy(function(event,data){data.rslt.cy&&data.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(obj,allow_multiple){if("undefined"==typeof obj||null===obj)return allow_multiple?this.data.ui.selected:this.data.ui.last_selected;var $obj=$(obj,this.get_container());return $obj.is(".jstree")||-1==obj?-1:($obj=$obj.closest("li",this.get_container()),$obj.length?$obj:!1)},_ui_notify:function(n,data){data.selected&&this.select_node(n,!1)},save_selected:function(){var _this=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&_this.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),$.each(s,function(i,val){val&&"#"!==val&&_this.select_node(val)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(){return this.save_selected(),this.__call_old()},hover_node:function(obj){return obj=this._get_node(obj),obj.length?(obj.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=obj.children("a").addClass("jstree-hovered").parent(),this._fix_scroll(obj),void this.__callback({obj:obj})):!1},dehover_node:function(){var p,obj=this.data.ui.hovered;return obj&&obj.length?(p=obj.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===p[0]&&(this.data.ui.hovered=null),void this.__callback({obj:obj})):!1},select_node:function(obj,check,e){if(obj=this._get_node(obj),-1==obj||!obj||!obj.length)return!1;var s=this._get_settings().ui,is_multiple="on"==s.select_multiple_modifier||s.select_multiple_modifier!==!1&&e&&e[s.select_multiple_modifier+"Key"],is_range=s.select_range_modifier!==!1&&e&&e[s.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==obj[0]&&this.data.ui.last_selected.parent()[0]===obj.parent()[0],is_selected=this.is_selected(obj),proceed=!0,t=this;if(check){if(s.disable_selecting_children&&is_multiple&&(obj.parentsUntil(".jstree","li").children("a.jstree-clicked").length||obj.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;switch(proceed=!1,!0){case is_range:this.data.ui.last_selected.addClass("jstree-last-selected"),obj=obj[obj.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf(),-1==s.select_limit||obj.length<s.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==t.data.ui.last_selected[0]&&t.deselect_node(this)}),is_selected=!1,proceed=!0):proceed=!1;break;case is_selected&&!is_multiple:this.deselect_all(),is_selected=!1,proceed=!0;break;case!is_selected&&!is_multiple:(-1==s.select_limit||s.select_limit>0)&&(this.deselect_all(),proceed=!0);break;case is_selected&&is_multiple:this.deselect_node(obj);break;case!is_selected&&is_multiple:(-1==s.select_limit||this.data.ui.selected.length+1<=s.select_limit)&&(proceed=!0)}}proceed&&!is_selected&&(is_range||(this.data.ui.last_selected=obj),obj.children("a").addClass("jstree-clicked"),s.selected_parent_open&&obj.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(obj),this._fix_scroll(obj.eq(0)),this.__callback({obj:obj,e:e}))},_fix_scroll:function(obj){var t,c=this.get_container()[0];if(c.scrollHeight>c.offsetHeight){if(obj=this._get_node(obj),!obj||-1===obj||!obj.length||!obj.is(":visible"))return;t=obj.offset().top-this.get_container().offset().top,0>t&&(c.scrollTop=c.scrollTop+t-1),t+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?scrollbar_width:0)>c.offsetHeight&&(c.scrollTop=c.scrollTop+(t-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?scrollbar_width:0)))}},deselect_node:function(obj){return obj=this._get_node(obj),obj.length?void(this.is_selected(obj)&&(obj.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(obj),this.data.ui.last_selected.get(0)===obj.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:obj}))):!1},toggle_select:function(obj){return obj=this._get_node(obj),obj.length?void(this.is_selected(obj)?this.deselect_node(obj):this.select_node(obj)):!1},is_selected:function(obj){return this.data.ui.selected.index(this._get_node(obj))>=0},get_selected:function(context){return context?$(context).find("a.jstree-clicked").parent():this.data.ui.selected
},deselect_all:function(context){var ret=context?$(context).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();ret.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=$([]),this.data.ui.last_selected=!1,this.__callback({obj:ret})}}}),$.jstree.defaults.plugins.push("ui")}(jQuery),function($){$.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",$.proxy(function(e,data){if(this._get_settings().crrm.move.open_onmove){var t=this;data.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(obj,callback){obj=this._get_node(obj);var rtl=this._get_settings().core.rtl,w=this._get_settings().crrm.input_width_limit,w1=obj.children("ins").width(),w2=obj.find("> a:visible > ins").width()*obj.find("> a:visible > ins").length,t=this.get_text(obj),h1=$("<div />",{css:{position:"absolute",top:"-200px",left:rtl?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h2=obj.css("position","relative").append($("<input />",{value:t,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:rtl?"auto":w1+w2+4+"px",right:rtl?w1+w2+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:$.proxy(function(){var i=obj.children(".jstree-rename-input"),v=i.val();""===v&&(v=t),h1.remove(),i.remove(),this.set_text(obj,t),this.rename_node(obj,v),callback.call(this,obj,v,t),obj.css("position","")},this),keyup:function(event){var key=event.keyCode||event.which;return 27==key?(this.value=t,void this.blur()):13==key?void this.blur():void h2.width(Math.min(h1.text("pW"+this.value).width(),w))},keypress:function(event){var key=event.keyCode||event.which;return 13==key?!1:void 0}})).children(".jstree-rename-input");this.set_text(obj,""),h1.css({fontFamily:h2.css("fontFamily")||"",fontSize:h2.css("fontSize")||"",fontWeight:h2.css("fontWeight")||"",fontStyle:h2.css("fontStyle")||"",fontStretch:h2.css("fontStretch")||"",fontVariant:h2.css("fontVariant")||"",letterSpacing:h2.css("letterSpacing")||"",wordSpacing:h2.css("wordSpacing")||""}),h2.width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select()},rename:function(obj){obj=this._get_node(obj),this.__rollback();var f=this.__callback;this._show_input(obj,function(obj,new_name,old_name){f.call(this,{obj:obj,new_name:new_name,old_name:old_name})})},create:function(obj,position,js,callback,skip_rename){var t,_this=this;return obj=this._get_node(obj),obj||(obj=-1),this.__rollback(),t=this.create_node(obj,position,js,function(t){var p=this._get_parent(t),pos=$(t).index();callback&&callback.call(this,t),p.length&&p.hasClass("jstree-closed")&&this.open_node(p,!1,!0),skip_rename?_this.__callback({obj:t,name:this.get_text(t),parent:p,position:pos}):this._show_input(t,function(obj,new_name){_this.__callback({obj:obj,name:new_name,parent:p,position:pos})})})},remove:function(obj){obj=this._get_node(obj,!0);var p=this._get_parent(obj),prev=this._get_prev(obj);this.__rollback(),obj=this.delete_node(obj),obj!==!1&&this.__callback({obj:obj,prev:prev,parent:p})},check_move:function(){if(!this.__call_old())return!1;var s=this._get_settings().crrm.move;return s.check_move.call(this,this._get_move())?!0:!1},move_node:function(obj,ref,position,is_copy,is_prepared,skip_check){var s=this._get_settings().crrm.move;return is_prepared?((s.always_copy===!0||"multitree"===s.always_copy&&obj.rt.get_index()!==obj.ot.get_index())&&(is_copy=!0),void this.__call_old(!0,obj,ref,position,is_copy,!0,skip_check)):("undefined"==typeof position&&(position=s.default_position),"inside"!==position||s.default_position.match(/^(before|after)$/)||(position=s.default_position),this.__call_old(!0,obj,ref,position,is_copy,!1,skip_check))},cut:function(obj){return obj=this._get_node(obj,!0),obj&&obj.length?(this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=obj,void this.__callback({obj:obj})):!1},copy:function(obj){return obj=this._get_node(obj,!0),obj&&obj.length?(this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=obj,void this.__callback({obj:obj})):!1},paste:function(obj){if(obj=this._get_node(obj),!obj||!obj.length)return!1;var nodes=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;return this.data.crrm.ct_nodes||this.data.crrm.cp_nodes?(this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,obj),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,obj,!1,!0),void this.__callback({obj:obj,nodes:nodes})):!1}}})}(jQuery),function($){var themes_loaded=[];$.jstree._themes=!1,$.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",$.proxy(function(){var s=this._get_settings().themes;this.data.themes.dots=s.dots,this.data.themes.icons=s.icons,this.set_theme(s.theme,s.url)},this)).bind("loaded.jstree",$.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(theme_name,theme_url){return theme_name?(theme_url||(theme_url=$.jstree._themes+theme_name+"/style.css"),-1==$.inArray(theme_url,themes_loaded)&&($.vakata.css.add_sheet({url:theme_url}),themes_loaded.push(theme_url)),this.data.themes.theme!=theme_name&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=theme_name),this.get_container().addClass("jstree-"+theme_name),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),void this.__callback()):!1},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),$(function(){$.jstree._themes===!1&&$("script").each(function(){return this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)?($.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1):void 0}),$.jstree._themes===!1&&($.jstree._themes="themes/")}),$.jstree.defaults.plugins.push("themes")}(jQuery),function($){function exec(i,event){var tmp,f=$.jstree._focused();return f&&f.data&&f.data.hotkeys&&f.data.hotkeys.enabled&&(tmp=f._get_settings().hotkeys[i])?tmp.call(f,event):void 0}var bound=[];$.jstree.plugin("hotkeys",{__init:function(){if("undefined"==typeof $.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";$.each(this._get_settings().hotkeys,function(i,v){v!==!1&&-1==$.inArray(i,bound)&&($(document).bind("keydown",i,function(event){return exec(i,event)}),bound.push(i))}),this.get_container().bind("lock.jstree",$.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",$.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(o)),!1},"ctrl+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(o)),!1},"shift+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(o)),!1},down:function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(o)),!1},"ctrl+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(o)),!1},"shift+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(o)),!1},left:function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&(o.hasClass("jstree-open")?this.close_node(o):this.hover_node(this._get_prev(o))),!1},"ctrl+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&(o.hasClass("jstree-open")?this.close_node(o):this.hover_node(this._get_prev(o))),!1},"shift+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&(o.hasClass("jstree-open")?this.close_node(o):this.hover_node(this._get_prev(o))),!1},right:function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&o.length&&(o.hasClass("jstree-closed")?this.open_node(o):this.hover_node(this._get_next(o))),!1},"ctrl+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&o.length&&(o.hasClass("jstree-closed")?this.open_node(o):this.hover_node(this._get_next(o))),!1},"shift+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;return o&&o.length&&(o.hasClass("jstree-closed")?this.open_node(o):this.hover_node(this._get_next(o))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(event){return event.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(event),!1},"shift+space":function(event){return event.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(event),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function($){$.jstree.plugin("json_data",{__init:function(){var s=this._get_settings().json_data;s.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,data){data.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_json(obj,function(){_this.__callback({obj:_this._get_node(obj)}),s_call.call(this)},e_call)},_is_loaded:function(obj){var s=this._get_settings().json_data;return obj=this._get_node(obj),-1==obj||!obj||!s.ajax&&!s.progressive_render&&!$.isFunction(s.data)||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").length>0},refresh:function(obj){obj=this._get_node(obj);var s=this._get_settings().json_data;return obj&&-1!==obj&&s.progressive_unload&&($.isFunction(s.data)||s.ajax)&&obj.removeData("jstree_children"),this.__call_old()},load_node_json:function(obj,s_call,e_call){var d,s=this.get_settings().json_data,error_func=function(){},success_func=function(){};if(obj=this._get_node(obj),obj&&-1!==obj&&(s.progressive_render||s.progressive_unload)&&!obj.is(".jstree-open, .jstree-leaf")&&0===obj.children("ul").children("li").length&&obj.data("jstree_children"))return d=this._parse_json(obj.data("jstree_children"),obj),d&&(obj.append(d),s.progressive_unload||obj.removeData("jstree_children")),this.clean_node(obj),void(s_call&&s_call.call(this));if(obj&&-1!==obj){if(obj.data("jstree_is_loading"))return;obj.data("jstree_is_loading",!0)}switch(!0){case!s.data&&!s.ajax:throw"Neither data nor ajax settings supplied.";case $.isFunction(s.data):s.data.call(this,obj,$.proxy(function(d){d=this._parse_json(d,obj),d?(-1!==obj&&obj?(obj.append(d).children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()),this.clean_node(obj),s_call&&s_call.call(this)):(-1!==obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&this.correct_state(obj)):s.correct_state&&this.get_container().children("ul").empty(),e_call&&e_call.call(this))},this));break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!obj||-1===obj):obj&&-1!=obj||(d=this._parse_json(s.data,obj),d?(this.get_container().children("ul").empty().append(d.children()),this.clean_node()):s.correct_state&&this.get_container().children("ul").empty()),s_call&&s_call.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&obj&&-1!==obj:error_func=function(x,t,e){var ef=this.get_settings().json_data.ajax.error;ef&&ef.call(this,x,t,e),-1!=obj&&obj.length?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),"success"===t&&s.correct_state&&this.correct_state(obj)):"success"===t&&s.correct_state&&this.get_container().children("ul").empty(),e_call&&e_call.call(this)},success_func=function(d,t,x){var sf=this.get_settings().json_data.ajax.success;return sf&&(d=sf.call(this,d,t,x)||d),""===d||d&&d.toString&&""===d.toString().replace(/^[\s\n]+$/,"")||!$.isArray(d)&&!$.isPlainObject(d)?error_func.call(this,x,t,""):(d=this._parse_json(d,obj),void(d?(-1!==obj&&obj?(obj.append(d).children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()),this.clean_node(obj),s_call&&s_call.call(this)):-1!==obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this))))},s.ajax.context=this,s.ajax.error=error_func,s.ajax.success=success_func,s.ajax.dataType||(s.ajax.dataType="json"),$.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,obj)),$.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,obj)),$.ajax(s.ajax)}},_parse_json:function(js,obj,is_callback){var tmp,i,j,ul1,ul2,d=!1,p=this._get_settings(),s=p.json_data,t=p.core.html_titles;if(!js)return d;if(s.progressive_unload&&obj&&-1!==obj&&obj.data("jstree_children",d),$.isArray(js)){if(d=$(),!js.length)return!1;for(i=0,j=js.length;j>i;i++)tmp=this._parse_json(js[i],obj,!0),tmp.length&&(d=d.add(tmp))}else{if("string"==typeof js&&(js={data:js}),!js.data&&""!==js.data)return d;d=$("<li />"),js.attr&&d.attr(js.attr),js.metadata&&d.data(js.metadata),js.state&&d.addClass("jstree-"+js.state),$.isArray(js.data)||(tmp=js.data,js.data=[],js.data.push(tmp)),$.each(js.data,function(i,m){tmp=$("<a />"),$.isFunction(m)&&(m=m.call(this,js)),"string"==typeof m?tmp.attr("href","#")[t?"html":"text"](m):(m.attr||(m.attr={}),m.attr.href||(m.attr.href="#"),tmp.attr(m.attr)[t?"html":"text"](m.title),m.language&&tmp.addClass(m.language)),tmp.prepend("<ins class='jstree-icon'>&#160;</ins>"),!m.icon&&js.icon&&(m.icon=js.icon),m.icon&&(-1===m.icon.indexOf("/")?tmp.children("ins").addClass(m.icon):tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat")),d.append(tmp)}),d.prepend("<ins class='jstree-icon'>&#160;</ins>"),js.children&&(s.progressive_render&&"open"!==js.state?d.addClass("jstree-closed").data("jstree_children",js.children):(s.progressive_unload&&d.data("jstree_children",js.children),$.isArray(js.children)&&js.children.length&&(tmp=this._parse_json(js.children,obj,!0),tmp.length&&(ul2=$("<ul />"),ul2.append(tmp),d.append(ul2)))))}return is_callback||(ul1=$("<ul />"),ul1.append(d),d=ul1),d},get_json:function(obj,li_attr,a_attr,is_callback){var tmp1,tmp2,li,a,t,lang,result=[],s=this._get_settings(),_this=this;return obj=this._get_node(obj),obj&&-1!==obj||(obj=this.get_container().find("> ul > li")),li_attr=$.isArray(li_attr)?li_attr:["id","class"],!is_callback&&this.data.types&&li_attr.push(s.types.type_attr),a_attr=$.isArray(a_attr)?a_attr:[],obj.each(function(){li=$(this),tmp1={data:[]},li_attr.length&&(tmp1.attr={}),$.each(li_attr,function(i,v){tmp2=li.attr(v),tmp2&&tmp2.length&&tmp2.replace(/jstree[^ ]*/gi,"").length&&(tmp1.attr[v]=(" "+tmp2).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))}),li.hasClass("jstree-open")&&(tmp1.state="open"),li.hasClass("jstree-closed")&&(tmp1.state="closed"),li.data()&&(tmp1.metadata=li.data()),a=li.children("a"),a.each(function(){t=$(this),a_attr.length||-1!==$.inArray("languages",s.plugins)||t.children("ins").get(0).style.backgroundImage.length||t.children("ins").get(0).className&&t.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").length?(lang=!1,-1!==$.inArray("languages",s.plugins)&&$.isArray(s.languages)&&s.languages.length&&$.each(s.languages,function(l,lv){return t.hasClass(lv)?(lang=lv,!1):void 0}),tmp2={attr:{},title:_this.get_text(t,lang)},$.each(a_attr,function(k,z){tmp2.attr[z]=(" "+(t.attr(z)||"")).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,"")}),-1!==$.inArray("languages",s.plugins)&&$.isArray(s.languages)&&s.languages.length&&$.each(s.languages,function(k,z){return t.hasClass(z)?(tmp2.language=z,!0):void 0}),t.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"").length&&(tmp2.icon=t.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,"")),t.children("ins").get(0).style.backgroundImage.length&&(tmp2.icon=t.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):tmp2=_this.get_text(t),a.length>1?tmp1.data.push(tmp2):tmp1.data=tmp2}),li=li.find("> ul > li"),li.length&&(tmp1.children=_this.get_json(li,li_attr,a_attr,!0)),result.push(tmp1)}),result}}})}(jQuery),function($){$.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(i){var langs=this._get_settings().languages,st=!1,selector=".jstree-"+this.get_index()+" a";if(!$.isArray(langs)||0===langs.length)return!1;if(-1==$.inArray(i,langs)){if(!langs[i])return!1;i=langs[i]}return i==this.data.languages.current_language?!0:(st=$.vakata.css.get_css(selector+"."+this.data.languages.current_language,!1,this.data.languages.language_css),st!==!1&&(st.style.display="none"),st=$.vakata.css.get_css(selector+"."+i,!1,this.data.languages.language_css),st!==!1&&(st.style.display=""),this.data.languages.current_language=i,this.__callback(i),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(key,lang){var langs=this._get_settings().languages,s=this._get_settings().core.strings;return $.isArray(langs)&&langs.length&&(lang=lang&&-1!=$.inArray(lang,langs)?lang:this.data.languages.current_language),s[lang]&&s[lang][key]?s[lang][key]:s[key]?s[key]:key},get_text:function(obj,lang){if(obj=this._get_node(obj)||this.data.ui.last_selected,!obj.size())return!1;var langs=this._get_settings().languages,s=this._get_settings().core.html_titles;return $.isArray(langs)&&langs.length?(lang=lang&&-1!=$.inArray(lang,langs)?lang:this.data.languages.current_language,obj=obj.children("a."+lang)):obj=obj.children("a:eq(0)"),s?(obj=obj.clone(),obj.children("INS").remove(),obj.html()):(obj=obj.contents().filter(function(){return 3==this.nodeType})[0],obj.nodeValue)},set_text:function(obj,val,lang){if(obj=this._get_node(obj)||this.data.ui.last_selected,!obj.size())return!1;var tmp,langs=this._get_settings().languages,s=this._get_settings().core.html_titles;return $.isArray(langs)&&langs.length?(lang=lang&&-1!=$.inArray(lang,langs)?lang:this.data.languages.current_language,obj=obj.children("a."+lang)):obj=obj.children("a:eq(0)"),s?(tmp=obj.children("INS").clone(),obj.html(val).prepend(tmp),this.__callback({obj:obj,name:val,lang:lang}),!0):(obj=obj.contents().filter(function(){return 3==this.nodeType})[0],this.__callback({obj:obj,name:val,lang:lang}),obj.nodeValue=val)},_load_css:function(){var ln,langs=this._get_settings().languages,str="/* languages css */",selector=".jstree-"+this.get_index()+" a";if($.isArray(langs)&&langs.length){for(this.data.languages.current_language=langs[0],ln=0;ln<langs.length;ln++)str+=selector+"."+langs[ln]+" {",langs[ln]!=this.data.languages.current_language&&(str+=" display:none; "),str+=" } ";this.data.languages.language_css=$.vakata.css.add_sheet({str:str,title:"jstree-languages"})}},create_node:function(obj,position,js,callback){var t=this.__call_old(!0,obj,position,js,function(t){var ln,langs=this._get_settings().languages,a=t.children("a");if($.isArray(langs)&&langs.length){for(ln=0;ln<langs.length;ln++)a.is("."+langs[ln])||t.append(a.eq(0).clone().removeClass(langs.join(" ")).addClass(langs[ln]));a.not("."+langs.join(", .")).remove()}callback&&callback.call(this,t)});return t}}})}(jQuery),function($){$.jstree.plugin("cookies",{__init:function(){if("undefined"==typeof $.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var tmp,s=this._get_settings().cookies;s.save_loaded&&(tmp=$.cookie(s.save_loaded),tmp&&tmp.length&&(this.data.core.to_load=tmp.split(","))),s.save_opened&&(tmp=$.cookie(s.save_opened),tmp&&tmp.length&&(this.data.core.to_open=tmp.split(","))),s.save_selected&&(tmp=$.cookie(s.save_selected),tmp&&tmp.length&&this.data.ui&&(this.data.ui.to_select=tmp.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",$.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",$.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(c){if(!this.data.core.refreshing){var s=this._get_settings().cookies;if(!c)return s.save_loaded&&(this.save_loaded(),$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options)),s.save_opened&&(this.save_opened(),$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options)),void(s.save_selected&&this.data.ui&&(this.save_selected(),$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options)));switch(c){case"open_node":case"close_node":s.save_opened&&(this.save_opened(),$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options)),s.save_loaded&&(this.save_loaded(),$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options));break;case"select_node":case"deselect_node":s.save_selected&&this.data.ui&&(this.save_selected(),$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options))}}}}})}(jQuery),function($){$.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",$.proxy(function(e,data){var obj=this._get_node(data.rslt.obj);obj=-1===obj?this.get_container().children("ul"):obj.children("ul"),this.sort(obj)},this)).bind("rename_node.jstree create_node.jstree create.jstree",$.proxy(function(e,data){this.sort(data.rslt.obj.parent())},this)).bind("move_node.jstree",$.proxy(function(e,data){var m=-1==data.rslt.np?this.get_container():data.rslt.np;this.sort(m.children("ul"))},this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(obj){var s=this._get_settings().sort,t=this;obj.append($.makeArray(obj.children("li")).sort($.proxy(s,t))),obj.find("> li > ul").each(function(){t.sort($(this))}),this.clean_node(obj)}}})}(jQuery),function($){var o=!1,r=!1,m=!1,ml=!1,sli=!1,sti=!1,dir1=!1,dir2=!1,last_pos=!1;$.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(e,data,html){$.vakata.dnd.is_drag&&$.vakata.drag_stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.MozUserSelect="none")}catch(err){}return $.vakata.dnd.init_x=e.pageX,$.vakata.dnd.init_y=e.pageY,$.vakata.dnd.user_data=data,$.vakata.dnd.is_down=!0,$.vakata.dnd.helper=$("<div id='vakata-dragged' />").html(html),$(document).bind("mousemove",$.vakata.dnd.drag),$(document).bind("mouseup",$.vakata.dnd.drag_stop),!1},drag:function(e){if($.vakata.dnd.is_down){if(!$.vakata.dnd.is_drag){if(!(Math.abs(e.pageX-$.vakata.dnd.init_x)>5||Math.abs(e.pageY-$.vakata.dnd.init_y)>5))return;$.vakata.dnd.helper.appendTo("body"),$.vakata.dnd.is_drag=!0,$(document).triggerHandler("drag_start.vakata",{event:e,data:$.vakata.dnd.user_data})}if("mousemove"===e.type){var d=$(document),t=d.scrollTop(),l=d.scrollLeft();e.pageY-t<20?(sti&&"down"===dir1&&(clearInterval(sti),sti=!1),sti||(dir1="up",sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()-$.vakata.dnd.scroll_spd)},150))):sti&&"up"===dir1&&(clearInterval(sti),sti=!1),$(window).height()-(e.pageY-t)<20?(sti&&"up"===dir1&&(clearInterval(sti),sti=!1),sti||(dir1="down",sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()+$.vakata.dnd.scroll_spd)},150))):sti&&"down"===dir1&&(clearInterval(sti),sti=!1),e.pageX-l<20?(sli&&"right"===dir2&&(clearInterval(sli),sli=!1),sli||(dir2="left",sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()-$.vakata.dnd.scroll_spd)},150))):sli&&"left"===dir2&&(clearInterval(sli),sli=!1),$(window).width()-(e.pageX-l)<20?(sli&&"left"===dir2&&(clearInterval(sli),sli=!1),sli||(dir2="right",sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()+$.vakata.dnd.scroll_spd)},150))):sli&&"right"===dir2&&(clearInterval(sli),sli=!1)}$.vakata.dnd.helper.css({left:e.pageX+$.vakata.dnd.helper_left+"px",top:e.pageY+$.vakata.dnd.helper_top+"px"}),$(document).triggerHandler("drag.vakata",{event:e,data:$.vakata.dnd.user_data})}},drag_stop:function(e){sli&&clearInterval(sli),sti&&clearInterval(sti),$(document).unbind("mousemove",$.vakata.dnd.drag),$(document).unbind("mouseup",$.vakata.dnd.drag_stop),$(document).triggerHandler("drag_stop.vakata",{event:e,data:$.vakata.dnd.user_data}),$.vakata.dnd.helper.remove(),$.vakata.dnd.init_x=0,$.vakata.dnd.init_y=0,$.vakata.dnd.user_data={},$.vakata.dnd.is_down=!1,$.vakata.dnd.is_drag=!1}},$(function(){var css_string="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";$.vakata.css.add_sheet({str:css_string,title:"vakata"})}),$.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&(this.data.themes&&(m.attr("class","jstree-"+this.data.themes.theme),ml&&ml.attr("class","jstree-"+this.data.themes.theme),$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target)){var dc,tr=$.jstree._reference(e.target);tr.data.dnd.foreign?(dc=tr._get_settings().dnd.drag_check.call(this,{o:o,r:tr.get_container(),is_root:!0}),(dc===!0||dc.inside===!0||dc.before===!0||dc.after===!0)&&$.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(tr.prepare_move(o,tr.get_container(),"last"),tr.check_move()&&$.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}},this)).bind("mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var dc,tr=$.jstree._reference(e.currentTarget);tr.data.dnd.foreign?(dc=tr._get_settings().dnd.drag_check.call(this,{o:o,r:tr.get_container(),is_root:!0}),(dc===!0||dc.inside===!0||dc.before===!0||dc.after===!0)&&tr._get_settings().dnd.drag_finish.call(this,{o:o,r:tr.get_container(),is_root:!0})):tr.move_node(o,tr.get_container(),"last",e[tr._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",$.proxy(function(e){return e.relatedTarget&&e.relatedTarget.id&&"jstree-marker-line"===e.relatedTarget.id?!1:void($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),$.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")))},this)).bind("mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){var cnt=this.get_container()[0];e.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft+=$.vakata.dnd.scroll_spd},cnt),100)):e.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft-=$.vakata.dnd.scroll_spd},cnt),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),e.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop+=$.vakata.dnd.scroll_spd},cnt),100)):e.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop-=$.vakata.dnd.scroll_spd},cnt),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",$.proxy(function(){$.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&m&&ml&&(m.hide(),ml.hide())},this)).delegate("a","mousedown.jstree",$.proxy(function(e){return 1===e.which?(this.start_drag(e.currentTarget,e),!1):void 0},this)).delegate("a","mouseenter.jstree",$.proxy(function(e){$.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&this.dnd_enter(e.currentTarget)},this)).delegate("a","mousemove.jstree",$.proxy(function(e){$.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&(r&&r.length&&r.children("a")[0]===e.currentTarget||this.dnd_enter(e.currentTarget),"undefined"==typeof this.data.dnd.off.top&&(this.data.dnd.off=$(e.target).offset()),this.data.dnd.w=(e.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(e.relatedTarget&&e.relatedTarget.id&&"jstree-marker-line"===e.relatedTarget.id)return!1;m&&m.hide(),ml&&ml.hide(),this.data.dnd.mto=setTimeout(function(t){return function(){t.dnd_leave(e)}}(this),0)}},this)).delegate("a","mouseup.jstree",$.proxy(function(e){$.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&this.dnd_finish(e)},this)),$(document).bind("drag_stop.vakata",$.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,m&&m.css({top:"-2000px"}),ml&&ml.css({top:"-2000px"})},this)).bind("drag_start.vakata",$.proxy(function(e,data){if(data.data.jstree){var et=$(data.event.target);et.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(et)}},this));var s=this._get_settings().dnd;s.drag_target&&$(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),$.proxy(function(e){o=e.target,$.vakata.dnd.drag_start(e,{jstree:!0,obj:e.target},"<ins class='jstree-icon'></ins>"+$(e.target).text()),this.data.themes&&(m&&m.attr("class","jstree-"+this.data.themes.theme),ml&&ml.attr("class","jstree-"+this.data.themes.theme),$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");
var cnt=this.get_container();this.data.dnd.cof=cnt.offset(),this.data.dnd.cw=parseInt(cnt.width(),10),this.data.dnd.ch=parseInt(cnt.height(),10),this.data.dnd.foreign=!0,e.preventDefault()},this)),s.drop_target&&$(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),$.proxy(function(e){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:o,r:$(e.target),e:e})&&$.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),$.proxy(function(){this.data.dnd.active&&$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),$.proxy(function(e){this.data.dnd.active&&$.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:o,r:$(e.target),e:e})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:$.noop,drag_target:".jstree-draggable",drag_finish:$.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(r&&r.length){if(this.data.dnd.off=r.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+r.width()),this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:o,r:r});return this.data.dnd.after=a.after,this.data.dnd.before=a.before,this.data.dnd.inside=a.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(o,r,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(o,r,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(r)?(this.prepare_move(o,r,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var pos,o=["before","inside","after"],r=!1,rtl=this._get_settings().core.rtl;switch(o=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"],$.each(o,$.proxy(function(i,val){return this.data.dnd[val]?($.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),r=val,!1):void 0},this)),r===!1&&$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),pos=rtl?this.data.dnd.off.right-18:this.data.dnd.off.left+10,r){case"before":m.css({left:pos+"px",top:this.data.dnd.off.top-6+"px"}).show(),ml&&ml.css({left:pos+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":m.css({left:pos+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),ml&&ml.css({left:pos+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":m.css({left:pos+(rtl?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),ml&&ml.hide();break;default:m.hide(),ml&&ml.hide()}return last_pos=r,r}},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(r,$.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:o,r:r,p:last_pos}):(this.dnd_prepare(),this.move_node(o,r,last_pos,e[this._get_settings().dnd.copy_modifier+"Key"])),o=!1,r=!1,m.hide(),ml&&ml.hide()},dnd_enter:function(obj){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var s=this._get_settings().dnd;this.data.dnd.prepared=!1,r=this._get_node(obj),s.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout($.proxy(this.dnd_prepare,this),s.check_timeout)):this.dnd_prepare(),s.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),r&&r.length&&r.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout($.proxy(this.dnd_open,this),s.open_timeout))):r&&r.length&&r.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(e){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),m.hide(),ml&&ml.hide(),r&&r[0]===e.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(obj,e){o=this._get_node(obj),this.data.ui&&this.is_selected(o)&&(o=this._get_node(null,!0));var dt=o.length>1?this._get_string("multiple_selection"):this.get_text(o),cnt=this.get_container();this._get_settings().core.html_titles||(dt=dt.replace(/</gi,"&lt;").replace(/>/gi,"&gt;")),$.vakata.dnd.drag_start(e,{jstree:!0,obj:o},"<ins class='jstree-icon'></ins>"+dt),this.data.themes&&(m&&m.attr("class","jstree-"+this.data.themes.theme),ml&&ml.attr("class","jstree-"+this.data.themes.theme),$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=cnt.offset(),this.data.dnd.cw=parseInt(cnt.width(),10),this.data.dnd.ch=parseInt(cnt.height(),10),this.data.dnd.active=!0}}}),$(function(){var css_string="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";$.vakata.css.add_sheet({str:css_string,title:"jstree"}),m=$("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){return m.hide(),ml.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1}).appendTo("body"),ml=$("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){return r&&r.length?(r.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1):void 0}).bind("mouseleave",function(e){var rt=$(e.relatedTarget);return(rt.is(".jstree")||0===rt.closest(".jstree").length)&&r&&r.length?(r.children("a").trigger(e),m.hide(),ml.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1):void 0}).appendTo("body"),$(document).bind("drag_start.vakata",function(e,data){data.data.jstree&&(m.show(),ml&&ml.show())}),$(document).bind("drag_stop.vakata",function(e,data){data.data.jstree&&(m.hide(),ml&&ml.hide())})})}(jQuery),function($){$.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=$.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",$.proxy(function(e,data){this._prepare_checkboxes(data.rslt.obj)},this)).bind("loaded.jstree",$.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",$.proxy(function(e){return e.preventDefault(),this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target),this.data.ui&&this.data.checkbox.noui?(this.save_selected(),void(this.data.cookies&&this.save_cookie("select_node"))):(e.stopImmediatePropagation(),!1)},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(n){return["check_"+(n[0].id||Math.ceil(1e4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(n,data){data.checked&&this.check_node(n,!1)},_prepare_checkboxes:function(obj){if(obj=obj&&-1!=obj?this._get_node(obj):this.get_container().find("> ul > li"),obj!==!1){var c,t,_this=this,ts=this._get_settings().checkbox.two_state,rc=this._get_settings().checkbox.real_checkboxes,rcn=this._get_settings().checkbox.real_checkboxes_names;obj.each(function(){t=$(this),c=t.is("li")&&(t.hasClass("jstree-checked")||rc&&t.children(":checked").length)?"jstree-checked":"jstree-unchecked",t.find("li").andSelf().each(function(){var nm,$t=$(this);$t.children("a"+(_this.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(ts?"jstree-unchecked":c),rc&&($t.children(":checkbox").length?$t.children(":checkbox").addClass("jstree-real-checkbox"):(nm=rcn.call(_this,$t),$t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+nm[0]+"' name='"+nm[0]+"' value='"+nm[1]+"' />"))),ts?($t.hasClass("jstree-checked")||$t.children(":checked").length)&&$t.addClass("jstree-checked").children(":checkbox").prop("checked",!0):("jstree-checked"===c||$t.hasClass("jstree-checked")||$t.children(":checked").length)&&$t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})}),ts||obj.find(".jstree-checked").parent().parent().each(function(){_this._repair_state(this)})}},change_state:function(obj,state){obj=this._get_node(obj);var coll=!1,rc=this._get_settings().checkbox.real_checkboxes;if(!obj||-1===obj)return!1;if(state=state===!1||state===!0?state:obj.hasClass("jstree-checked"),this._get_settings().checkbox.two_state)state?(obj.removeClass("jstree-checked").addClass("jstree-unchecked"),rc&&obj.children(":checkbox").prop("checked",!1)):(obj.removeClass("jstree-unchecked").addClass("jstree-checked"),rc&&obj.children(":checkbox").prop("checked",!0));else{if(state){if(coll=obj.find("li").andSelf(),!coll.filter(".jstree-checked, .jstree-undetermined").length)return!1;coll.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),rc&&coll.children(":checkbox").prop("checked",!1)}else{if(coll=obj.find("li").andSelf(),!coll.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;coll.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),rc&&coll.children(":checkbox").prop("checked",!0),this.data.ui&&(this.data.ui.last_selected=obj),this.data.checkbox.last_selected=obj}obj.parentsUntil(".jstree","li").each(function(){var $this=$(this);if(state){if($this.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return $this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),rc&&$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;$this.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),rc&&$this.children(":checkbox").prop("checked",!1)}else{if($this.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return $this.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),rc&&$this.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;$this.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),rc&&$this.children(":checkbox").prop("checked",!0)}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(obj),!0},check_node:function(obj){if(this.change_state(obj,!1)){if(obj=this._get_node(obj),this._get_settings().checkbox.checked_parent_open){var t=this;obj.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:obj})}},uncheck_node:function(obj){this.change_state(obj,!0)&&this.__callback({obj:this._get_node(obj)})},check_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var _this=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){_this.change_state(this,!0)}),this.__callback()},is_checked:function(obj){return obj=this._get_node(obj),obj.length?obj.is(".jstree-checked"):!1},get_checked:function(obj,get_all){return obj=obj&&-1!==obj?this._get_node(obj):this.get_container(),obj.find(get_all||this._get_settings().checkbox.two_state?".jstree-checked":"> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(obj,get_all){return obj=obj&&-1!==obj?this._get_node(obj):this.get_container(),obj.find(get_all||this._get_settings().checkbox.two_state?".jstree-unchecked":"> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(obj){if(obj=this._get_node(obj),obj.length){if(this._get_settings().checkbox.two_state)return void obj.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);var rc=this._get_settings().checkbox.real_checkboxes,a=obj.find("> ul > .jstree-checked").length,b=obj.find("> ul > .jstree-undetermined").length,c=obj.find("> ul > li").length;0===c?obj.hasClass("jstree-undetermined")&&this.change_state(obj,!1):0===a&&0===b?this.change_state(obj,!0):a===c?this.change_state(obj,!1):(obj.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),rc&&obj.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var _this=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),$.each(s,function(i,val){_this.check_node(val)}),this.__callback()}else this.__call_old()},save_loaded:function(){var _this=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&_this.data.core.to_load.push("#"+this.id)})}}}),$(function(){var css_string=".jstree .jstree-real-checkbox { display:none; } ";$.vakata.css.add_sheet({str:css_string,title:"jstree"})})}(jQuery),function($){$.vakata.xslt=function(xml,xsl,callback){var xm,xs,processor,support,rs="";return document.recalc?(xm=document.createElement("xml"),xs=document.createElement("xml"),xm.innerHTML=xml,xs.innerHTML=xsl,$("body").append(xm).append(xs),setTimeout(function(xm,xs,callback){return function(){callback.call(null,xm.transformNode(xs.XMLDocument)),setTimeout(function(xm,xs){return function(){$(xm).remove(),$(xs).remove()}}(xm,xs),200)}}(xm,xs,callback),100),!0):("undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"==typeof window.XSLTProcessor&&(xml=(new DOMParser).parseFromString(xml,"text/xml"),xsl=(new DOMParser).parseFromString(xsl,"text/xml")),"undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"!=typeof window.XSLTProcessor?(processor=new XSLTProcessor,(support=$.isFunction(processor.transformDocument)?"undefined"!=typeof window.XMLSerializer:!0)?(xml=(new DOMParser).parseFromString(xml,"text/xml"),xsl=(new DOMParser).parseFromString(xsl,"text/xml"),$.isFunction(processor.transformDocument)?(rs=document.implementation.createDocument("","",null),processor.transformDocument(xml,xsl,rs,null),callback.call(null,(new XMLSerializer).serializeToString(rs)),!0):(processor.importStylesheet(xsl),rs=processor.transformToFragment(xml,document),callback.call(null,$("<div />").append(rs).html()),!0)):!1):!1)};var xsl={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},escape_xml=function(string){return string.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};$.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_xml(obj,function(){_this.__callback({obj:_this._get_node(obj)}),s_call.call(this)},e_call)},_is_loaded:function(obj){var s=this._get_settings().xml_data;return obj=this._get_node(obj),-1==obj||!obj||!s.ajax&&!$.isFunction(s.data)||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0},load_node_xml:function(obj,s_call,e_call){var s=this.get_settings().xml_data,error_func=function(){},success_func=function(){};if(obj=this._get_node(obj),obj&&-1!==obj){if(obj.data("jstree_is_loading"))return;obj.data("jstree_is_loading",!0)}switch(!0){case!s.data&&!s.ajax:throw"Neither data nor ajax settings supplied.";case $.isFunction(s.data):s.data.call(this,obj,$.proxy(function(d){this.parse_xml(d,$.proxy(function(d){d&&(d=d.replace(/ ?xmlns="[^"]*"/gi,""),d.length>10?(d=$(d),-1!==obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.append(d),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()),s.clean_node&&this.clean_node(obj),s_call&&s_call.call(this)):obj&&-1!==obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this)))},this))},this));break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!obj||-1===obj):obj&&-1!=obj||this.parse_xml(s.data,$.proxy(function(d){d?(d=d.replace(/ ?xmlns="[^"]*"/gi,""),d.length>10&&(d=$(d),this.get_container().children("ul").empty().append(d.children()),s.clean_node&&this.clean_node(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this))},this));break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&obj&&-1!==obj:error_func=function(x,t,e){var ef=this.get_settings().xml_data.ajax.error;ef&&ef.call(this,x,t,e),-1!==obj&&obj.length?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),"success"===t&&s.correct_state&&this.correct_state(obj)):"success"===t&&s.correct_state&&this.get_container().children("ul").empty(),e_call&&e_call.call(this)},success_func=function(d,t,x){d=x.responseText;var sf=this.get_settings().xml_data.ajax.success;return sf&&(d=sf.call(this,d,t,x)||d),""===d||d&&d.toString&&""===d.toString().replace(/^[\s\n]+$/,"")?error_func.call(this,x,t,""):void this.parse_xml(d,$.proxy(function(d){d&&(d=d.replace(/ ?xmlns="[^"]*"/gi,""),d.length>10?(d=$(d),-1!==obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.append(d),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()),s.clean_node&&this.clean_node(obj),s_call&&s_call.call(this)):obj&&-1!==obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this)))},this))},s.ajax.context=this,s.ajax.error=error_func,s.ajax.success=success_func,s.ajax.dataType||(s.ajax.dataType="xml"),$.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,obj)),$.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,obj)),$.ajax(s.ajax)}},parse_xml:function(xml,callback){var s=this._get_settings().xml_data;$.vakata.xslt(xml,xsl[s.xsl],callback)},get_xml:function(tp,obj,li_attr,a_attr,is_callback){var tmp1,tmp2,li,a,lang,result="",s=this._get_settings(),_this=this;return tp||(tp="flat"),is_callback||(is_callback=0),obj=this._get_node(obj),obj&&-1!==obj||(obj=this.get_container().find("> ul > li")),li_attr=$.isArray(li_attr)?li_attr:["id","class"],!is_callback&&this.data.types&&-1===$.inArray(s.types.type_attr,li_attr)&&li_attr.push(s.types.type_attr),a_attr=$.isArray(a_attr)?a_attr:[],is_callback||(s.xml_data.get_include_preamble&&(result+='<?xml version="1.0" encoding="UTF-8"?>'),result+="<root>"),obj.each(function(){result+="<item",li=$(this),$.each(li_attr,function(i,v){var t=li.attr(v);s.xml_data.get_skip_empty&&"undefined"==typeof t||(result+=" "+v+'="'+escape_xml((" "+(t||"")).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"')}),li.hasClass("jstree-open")&&(result+=' state="open"'),li.hasClass("jstree-closed")&&(result+=' state="closed"'),"flat"===tp&&(result+=' parent_id="'+escape_xml(is_callback)+'"'),result+=">",result+="<content>",a=li.children("a"),a.each(function(){tmp1=$(this),lang=!1,result+="<name",-1!==$.inArray("languages",s.plugins)&&$.each(s.languages,function(k,z){return tmp1.hasClass(z)?(result+=' lang="'+escape_xml(z)+'"',lang=z,!1):void 0}),a_attr.length&&$.each(a_attr,function(k,z){var t=tmp1.attr(z);s.xml_data.get_skip_empty&&"undefined"==typeof t||(result+=" "+z+'="'+escape_xml((" "+t||"").replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"')}),tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"").length&&(result+=' icon="'+escape_xml(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"'),tmp1.children("ins").get(0).style.backgroundImage.length&&(result+=' icon="'+escape_xml(tmp1.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/gi,"").replace(/"/gi,""))+'"'),result+=">",result+="<![CDATA["+_this.get_text(tmp1,lang)+"]]>",result+="</name>"}),result+="</content>",tmp2=li[0].id||!0,li=li.find("> ul > li"),tmp2=li.length?_this.get_xml(tp,li,li_attr,a_attr,tmp2):"","nest"==tp&&(result+=tmp2),result+="</item>","flat"==tp&&(result+=tmp2)}),is_callback||(result+="</root>"),result}}})}(jQuery),function($){$.expr[":"].jstree_contains=function(a,i,m){return(a.textContent||a.innerText||"").toLowerCase().indexOf(m[3].toLowerCase())>=0},$.expr[":"].jstree_title_contains=function(a,i,m){return(a.getAttribute("title")||"").toLowerCase().indexOf(m[3].toLowerCase())>=0},$.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=$(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(e,data){$(this).children("ul").find("li").hide().removeClass("jstree-last"),data.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){$(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(str,skip_async){if(""===$.trim(str))return void this.clear_search();var s=this.get_settings().search,t=this,error_func=function(){},success_func=function(){};return this.data.search.str=str,!skip_async&&s.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0?(this.search.supress_callback=!0,error_func=function(){},success_func=function(d,t,x){var sf=this.get_settings().search.ajax.success;sf&&(d=sf.call(this,d,t,x)||d),this.data.search.to_open=d,this._search_open()},s.ajax.context=this,s.ajax.error=error_func,s.ajax.success=success_func,$.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,str)),$.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,str)),s.ajax.data||(s.ajax.data={search_string:str}),(!s.ajax.dataType||/^json/.exec(s.ajax.dataType))&&(s.ajax.dataType="json"),void $.ajax(s.ajax)):(this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+s.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)}),void this.__callback({nodes:this.data.search.result,str:str}))},clear_search:function(){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=$()},_search_open:function(){var _this=this,done=!0,current=[],remaining=[];this.data.search.to_open.length&&($.each(this.data.search.to_open,function(i,val){return"#"==val?!0:void($(val).length&&$(val).is(".jstree-closed")?current.push(val):remaining.push(val))}),current.length&&(this.data.search.to_open=remaining,$.each(current,function(i,val){_this.open_node(val,function(){_this._search_open(!0)})}),done=!1)),done&&this.search(this.data.search.str,!0)}}})}(jQuery),function($){$.vakata.context={hide_on_mouseleave:!1,cnt:$("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(s,t,x,y,d,p,rtl){$.vakata.context.rtl=!!rtl;var h,w,html=$.vakata.context.parse(s);html&&($.vakata.context.vis=!0,$.vakata.context.tgt=t,$.vakata.context.par=p||t||null,$.vakata.context.data=d||null,$.vakata.context.cnt.html(html).css({visibility:"hidden",display:"block",left:0,top:0}),$.vakata.context.hide_on_mouseleave&&$.vakata.context.cnt.one("mouseleave",function(){$.vakata.context.hide()}),h=$.vakata.context.cnt.height(),w=$.vakata.context.cnt.width(),x+w>$(document).width()&&(x=$(document).width()-(w+5),$.vakata.context.cnt.find("li > ul").addClass("right")),y+h>$(document).height()&&(y-=h+t[0].offsetHeight,$.vakata.context.cnt.find("li > ul").addClass("bottom")),$.vakata.context.cnt.css({left:x,top:y}).find("li:has(ul)").bind("mouseenter",function(){var w=$(document).width(),h=$(document).height(),ul=$(this).children("ul").show();
w!==$(document).width()&&ul.toggleClass("right"),h!==$(document).height()&&ul.toggleClass("bottom")}).bind("mouseleave",function(){$(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),$(document).triggerHandler("context_show.vakata"))},hide:function(){$.vakata.context.vis=!1,$.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),$(document).triggerHandler("context_hide.vakata")},parse:function(s,is_callback){if(!s)return!1;var str="",tmp=!1,was_sep=!0;return is_callback||($.vakata.context.func={}),str+="<ul>",$.each(s,function(i,val){return val?($.vakata.context.func[i]=val.action,!was_sep&&val.separator_before&&(str+="<li class='vakata-separator vakata-separator-before'></li>"),was_sep=!1,str+="<li class='"+(val._class||"")+(val._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",val.icon&&-1===val.icon.indexOf("/")&&(str+=" class='"+val.icon+"' "),val.icon&&-1!==val.icon.indexOf("/")&&(str+=" style='background:url("+val.icon+") center center no-repeat;' "),str+=">&#160;</ins><a href='#' rel='"+i+"'>",val.submenu&&(str+="<span style='float:"+($.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),str+=val.label+"</a>",val.submenu&&(tmp=$.vakata.context.parse(val.submenu,!0),tmp&&(str+=tmp)),str+="</li>",void(val.separator_after&&(str+="<li class='vakata-separator vakata-separator-after'></li>",was_sep=!0))):!0}),str=str.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),str+="</ul>",$(document).triggerHandler("context_parse.vakata"),str.length>10?str:!1},exec:function(i){return $.isFunction($.vakata.context.func[i])?($.vakata.context.func[i].call($.vakata.context.data,$.vakata.context.par),!0):!1}},$(function(){var css_string="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";$.vakata.css.add_sheet({str:css_string,title:"vakata"}),$.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(){!$(this).parent().hasClass("jstree-contextmenu-disabled")&&$.vakata.context.exec($(this).attr("rel"))?$.vakata.context.hide():$(this).blur()}).delegate("a","mouseover",function(){$.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),$(document).bind("mousedown",function(e){$.vakata.context.vis&&!$.contains($.vakata.context.cnt[0],e.target)&&$.vakata.context.hide()}),"undefined"!=typeof $.hotkeys&&$(document).bind("keydown","up",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();o.length||(o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),o.addClass("vakata-hover"),e.stopImmediatePropagation(),e.preventDefault()}}).bind("keydown","down",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();o.length||(o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),o.addClass("vakata-hover"),e.stopImmediatePropagation(),e.preventDefault()}}).bind("keydown","right",function(e){$.vakata.context.vis&&($.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),e.stopImmediatePropagation(),e.preventDefault())}).bind("keydown","left",function(e){$.vakata.context.vis&&($.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),e.stopImmediatePropagation(),e.preventDefault())}).bind("keydown","esc",function(e){$.vakata.context.hide(),e.preventDefault()}).bind("keydown","space",function(e){$.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),e.preventDefault()})}),$.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",$.proxy(function(e){e.preventDefault(),$(e.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY)},this)).delegate("a","click.jstree",$.proxy(function(){this.data.contextmenu&&$.vakata.context.hide()},this)).bind("destroy.jstree",$.proxy(function(){this.data.contextmenu&&$.vakata.context.hide()},this)),$(document).bind("context_hide.vakata",$.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(obj){this.create(obj)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(obj){this.rename(obj)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(obj){this.is_selected(obj)?this.remove():this.remove(obj)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(obj){this.cut(obj)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(obj){this.copy(obj)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(obj){this.paste(obj)}}}}}},_fn:{show_contextmenu:function(obj,x,y){obj=this._get_node(obj);var s=this.get_settings().contextmenu,a=obj.children("a:visible:eq(0)"),o=!1,i=!1;s.select_node&&this.data.ui&&!this.is_selected(obj)&&(this.deselect_all(),this.select_node(obj,!0)),(s.show_at_node||"undefined"==typeof x||"undefined"==typeof y)&&(o=a.offset(),x=o.left,y=o.top+this.data.core.li_height),i=obj.data("jstree")&&obj.data("jstree").contextmenu?obj.data("jstree").contextmenu:s.items,$.isFunction(i)&&(i=i.call(this,obj)),this.data.contextmenu=!0,$.vakata.context.show(i,a,x,y,this,obj,this._get_settings().core.rtl),this.data.themes&&$.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function($){$.jstree.plugin("types",{__init:function(){var s=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",$.proxy(function(){var types=s.types,attr=s.type_attr,icons_css="",_this=this;$.each(types,function(i,tp){return $.each(tp,function(k){/^(max_depth|max_children|icon|valid_children)$/.test(k)||_this.data.types.attach_to.push(k)}),tp.icon?void((tp.icon.image||tp.icon.position)&&(icons_css+="default"==i?".jstree-"+_this.get_index()+" a > .jstree-icon { ":".jstree-"+_this.get_index()+" li["+attr+'="'+i+'"] > a > .jstree-icon { ',tp.icon.image&&(icons_css+=" background-image:url("+tp.icon.image+"); "),icons_css+=tp.icon.position?" background-position:"+tp.icon.position+"; ":" background-position:0 0; ",icons_css+="} ")):!0}),""!==icons_css&&$.vakata.css.add_sheet({str:icons_css,title:"jstree-types"})},this)).bind("before.jstree",$.proxy(function(e,data){var s,t,o=this._get_settings().types.use_data?this._get_node(data.args[0]):!1,d=o&&-1!==o&&o.length?o.data("jstree"):!1;if(d&&d.types&&d.types[data.func]===!1)return e.stopImmediatePropagation(),!1;if(-1!==$.inArray(data.func,this.data.types.attach_to)){if(!data.args[0]||!data.args[0].tagName&&!data.args[0].jquery)return;if(s=this._get_settings().types.types,t=this._get_type(data.args[0]),(s[t]&&"undefined"!=typeof s[t][data.func]||s["default"]&&"undefined"!=typeof s["default"][data.func])&&this._check(data.func,data.args[0])===!1)return e.stopImmediatePropagation(),!1}},this)),is_ie6&&this.get_container().bind("load_node.jstree set_type.jstree",$.proxy(function(e,data){var r=data&&data.rslt&&data.rslt.obj&&-1!==data.rslt.obj?this._get_node(data.rslt.obj).parent():this.get_container_ul(),c=!1,s=this._get_settings().types;$.each(s.types,function(i,tp){tp.icon&&(tp.icon.image||tp.icon.position)&&(c=r.find("default"===i?"li > a > .jstree-icon":"li["+s.type_attr+"='"+i+"'] > a > .jstree-icon"),tp.icon.image&&c.css("backgroundImage","url("+tp.icon.image+")"),c.css("backgroundPosition",tp.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(n,data){data.type&&this._get_settings().types.use_data&&this.set_type(data.type,n)},_get_type:function(obj){return obj=this._get_node(obj),obj&&obj.length?obj.attr(this._get_settings().types.type_attr)||"default":!1},set_type:function(str,obj){obj=this._get_node(obj);var ret=obj.length&&str?obj.attr(this._get_settings().types.type_attr,str):!1;return ret&&this.__callback({obj:obj,type:str}),ret},_check:function(rule,obj,opts){obj=this._get_node(obj);var v=!1,t=this._get_type(obj),d=0,_this=this,s=this._get_settings().types,data=!1;if(-1===obj){if(!s[rule])return;v=s[rule]}else{if(t===!1)return;data=s.use_data?obj.data("jstree"):!1,data&&data.types&&"undefined"!=typeof data.types[rule]?v=data.types[rule]:s.types[t]&&"undefined"!=typeof s.types[t][rule]?v=s.types[t][rule]:s.types["default"]&&"undefined"!=typeof s.types["default"][rule]&&(v=s.types["default"][rule])}return $.isFunction(v)&&(v=v.call(this,obj)),"max_depth"===rule&&-1!==obj&&opts!==!1&&-2!==s.max_depth&&0!==v&&obj.children("a:eq(0)").parentsUntil(".jstree","li").each(function(i){return-1!==s.max_depth&&s.max_depth-(i+1)<=0?(v=0,!1):(d=0===i?v:_this._check(rule,this,!1),-1!==d&&0>=d-(i+1)?(v=0,!1):(d>=0&&(v>d-(i+1)||0>v)&&(v=d-(i+1)),void(s.max_depth>=0&&(s.max_depth-(i+1)<v||0>v)&&(v=s.max_depth-(i+1)))))}),v},check_move:function(){if(!this.__call_old())return!1;var t,m=this._get_move(),s=m.rt._get_settings().types,mc=m.rt._check("max_children",m.cr),md=m.rt._check("max_depth",m.cr),vc=m.rt._check("valid_children",m.cr),ch=0,d=1;if("none"===vc)return!1;if($.isArray(vc)&&m.ot&&m.ot._get_type&&(m.o.each(function(){return-1===$.inArray(m.ot._get_type(this),vc)?(d=!1,!1):void 0}),d===!1))return!1;if(-2!==s.max_children&&-1!==mc&&(ch=-1===m.cr?this.get_container().find("> ul > li").not(m.o).length:m.cr.find("> ul > li").not(m.o).length,ch+m.o.length>mc))return!1;if(-2!==s.max_depth&&-1!==md){if(d=0,0===md)return!1;if("undefined"==typeof m.o.d){for(t=m.o;t.length>0;)t=t.find("> ul > li"),d++;m.o.d=d}if(md-m.o.d<0)return!1}return!0},create_node:function(obj,position,js,callback,is_loaded,skip_check){if(!skip_check&&(is_loaded||this._is_loaded(obj))){var ch,p="string"==typeof position&&position.match(/^before|after$/i)&&-1!==obj?this._get_parent(obj):this._get_node(obj),s=this._get_settings().types,mc=this._check("max_children",p),md=this._check("max_depth",p),vc=this._check("valid_children",p);if("string"==typeof js&&(js={data:js}),js||(js={}),"none"===vc)return!1;if($.isArray(vc))if(js.attr&&js.attr[s.type_attr]){if(-1===$.inArray(js.attr[s.type_attr],vc))return!1}else js.attr||(js.attr={}),js.attr[s.type_attr]=vc[0];if(-2!==s.max_children&&-1!==mc&&(ch=-1===p?this.get_container().find("> ul > li").length:p.find("> ul > li").length,ch+1>mc))return!1;if(-2!==s.max_depth&&-1!==md&&0>md-1)return!1}return this.__call_old(!0,obj,position,js,callback,is_loaded,skip_check)}}})}(jQuery),function($){$.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(obj,s_call,e_call){var _this=this;this.load_node_html(obj,function(){_this.__callback({obj:_this._get_node(obj)}),s_call.call(this)},e_call)},_is_loaded:function(obj){return obj=this._get_node(obj),-1==obj||!obj||!this._get_settings().html_data.ajax&&!$.isFunction(this._get_settings().html_data.data)||obj.is(".jstree-open, .jstree-leaf")||obj.children("ul").children("li").size()>0},load_node_html:function(obj,s_call,e_call){var d,s=this.get_settings().html_data,error_func=function(){},success_func=function(){};if(obj=this._get_node(obj),obj&&-1!==obj){if(obj.data("jstree_is_loading"))return;obj.data("jstree_is_loading",!0)}switch(!0){case $.isFunction(s.data):s.data.call(this,obj,$.proxy(function(d){d&&""!==d&&d.toString&&""!==d.toString().replace(/^[\s\n]+$/,"")?(d=$(d),d.is("ul")||(d=$("<ul />").append(d)),-1!=obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(obj),s_call&&s_call.call(this)):obj&&-1!==obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this))},this));break;case!s.data&&!s.ajax:obj&&-1!=obj||(this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),s_call&&s_call.call(this);break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!obj||-1===obj):obj&&-1!=obj||(d=$(s.data),d.is("ul")||(d=$("<ul />").append(d)),this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),s_call&&s_call.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&obj&&-1!==obj:obj=this._get_node(obj),error_func=function(x,t,e){var ef=this.get_settings().html_data.ajax.error;ef&&ef.call(this,x,t,e),-1!=obj&&obj.length?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),"success"===t&&s.correct_state&&this.correct_state(obj)):"success"===t&&s.correct_state&&this.get_container().children("ul").empty(),e_call&&e_call.call(this)},success_func=function(d,t,x){var sf=this.get_settings().html_data.ajax.success;return sf&&(d=sf.call(this,d,t,x)||d),""===d||d&&d.toString&&""===d.toString().replace(/^[\s\n]+$/,"")?error_func.call(this,x,t,""):void(d?(d=$(d),d.is("ul")||(d=$("<ul />").append(d)),-1!=obj&&obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),obj.removeData("jstree_is_loading")):this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(obj),s_call&&s_call.call(this)):obj&&-1!==obj?(obj.children("a.jstree-loading").removeClass("jstree-loading"),obj.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(obj),s_call&&s_call.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),s_call&&s_call.call(this)))},s.ajax.context=this,s.ajax.error=error_func,s.ajax.success=success_func,s.ajax.dataType||(s.ajax.dataType="html"),$.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,obj)),$.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,obj)),$.ajax(s.ajax)}}}}),$.jstree.defaults.plugins.push("html_data")}(jQuery),function($){$.jstree.plugin("themeroller",{__init:function(){var s=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(e){$(e.currentTarget).hasClass("jstree-loading")||$(this).addClass(s.item_h)}).delegate("a","mouseleave.jstree",function(){$(this).removeClass(s.item_h)}).bind("init.jstree",$.proxy(function(e,data){data.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(data.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",$.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.obj)},this)).bind("delete_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.parent)},this)).bind("correct_state.jstree",$.proxy(function(e,data){data.rslt.obj.children("ins.jstree-icon").removeClass(s.opened+" "+s.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")}).removeClass(s.item_open+" "+s.item_clsd).addClass(s.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").addClass(s.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",$.proxy(function(){this.get_container().find("a."+s.item_a).removeClass(s.item_a).end().find("a.jstree-clicked").addClass(s.item_a)},this)).bind("dehover_node.jstree",$.proxy(function(e,data){data.rslt.obj.children("a").removeClass(s.item_h)},this)).bind("hover_node.jstree",$.proxy(function(e,data){this.get_container().find("a."+s.item_h).not(data.rslt.obj).removeClass(s.item_h),data.rslt.obj.children("a").addClass(s.item_h)},this)).bind("move_node.jstree",$.proxy(function(e,data){this._themeroller(data.rslt.o),this._themeroller(data.rslt.op)},this))},__destroy:function(){var s=this._get_settings().themeroller,c=["ui-icon"];$.each(s,function(i,v){v=v.split(" "),v.length&&(c=c.concat(v))}),this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(obj){var s=this._get_settings().themeroller;obj=obj&&-1!=obj?this._get_node(obj).parent():this.get_container_ul(),obj.find("li.jstree-closed").children("ins.jstree-icon").removeClass(s.opened).addClass("ui-icon "+s.closed).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")}).removeClass(s.item_leaf+" "+s.item_open).addClass(s.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(s.closed).addClass("ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")}).removeClass(s.item_leaf+" "+s.item_clsd).addClass(s.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(s.closed+" ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")}).removeClass(s.item_clsd+" "+s.item_open).addClass(s.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),$(function(){var css_string=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";$.vakata.css.add_sheet({str:css_string,title:"jstree"})})}(jQuery),function($){$.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",$.proxy(function(e,data){var p,t,nms=[],res=!0;return"move_node"==data.func&&data.args[4]===!0&&data.args[0].o&&data.args[0].o.length&&(data.args[0].o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""))}),res=this._check_unique(nms,data.args[0].np.find("> ul > li").not(data.args[0].o),"move_node")),"create_node"==data.func&&(data.args[4]||this._is_loaded(data.args[0]))&&(p=this._get_node(data.args[0]),!data.args[1]||"before"!==data.args[1]&&"after"!==data.args[1]||(p=this._get_parent(data.args[0]),p&&-1!==p||(p=this.get_container())),nms.push("string"==typeof data.args[2]?data.args[2]:data.args[2]&&data.args[2].data?data.args[2].data:this._get_string("new_node")),res=this._check_unique(nms,p.find("> ul > li"),"create_node")),"rename_node"==data.func&&(nms.push(data.args[1]),t=this._get_node(data.args[0]),p=this._get_parent(t),p&&-1!==p||(p=this.get_container()),res=this._check_unique(nms,p.find("> ul > li").not(t),"rename_node")),res?void 0:(e.stopPropagation(),!1)},this))},defaults:{error_callback:$.noop},_fn:{_check_unique:function(nms,p,func){var cnms=[];return p.children("a").each(function(){cnms.push($(this).text().replace(/^\s+/g,""))}),cnms.length&&nms.length?(cnms=cnms.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),cnms.length+nms.length!=cnms.concat(nms).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,nms,p,func),!1):!0):!0},check_move:function(){if(!this.__call_old())return!1;var p=this._get_move(),nms=[];return p.o&&p.o.length?(p.o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""))}),this._check_unique(nms,p.np.find("> ul > li").not(p.o),"check_move")):!0}}})}(jQuery),function($){$.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",$.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",$.proxy(function(e,data){this._prepare_wholerow_span(data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",$.proxy(function(e,data){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(t,o){return function(){t._prepare_wholerow_ul(o)}}(this,data&&data.rslt&&data.rslt.obj?data.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",$.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",$.proxy(function(e,data){data.rslt.obj.each(function(){var ref=data.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt(($(this).offset().top-data.inst.get_container().offset().top+data.inst.get_container()[0].scrollTop)/data.inst.data.core.li_height,10)+")");ref.children("a").attr("class",data.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",$.proxy(function(e,data){if(this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:"")),"hover_node"===e.type){var ref=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((data.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");ref.children("a").attr("class",data.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var n=$(e.currentTarget);"A"===e.target.tagName||"INS"===e.target.tagName&&n.closest("li").is(".jstree-open, .jstree-closed")||(n.closest("li").children("a:visible:eq(0)").click(),e.stopImmediatePropagation())}).delegate("li","mouseover.jstree",$.proxy(function(e){return e.stopImmediatePropagation(),$(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(e.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",$.proxy(function(e){$(e.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(e.currentTarget)},this)),(is_ie7||is_ie6)&&$.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(obj){obj=obj&&-1!=obj?this._get_node(obj):this.get_container().find("> ul > li"),obj!==!1&&obj.each(function(){$(this).find("li").andSelf().each(function(){var $t=$(this);return $t.children(".jstree-wholerow-span").length?!0:void $t.prepend("<span class='jstree-wholerow-span' style='width:"+18*$t.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var o=this.get_container().children("ul").eq(0),h=o.html();o.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==h&&(this.data.wholerow.last_html=h,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(o.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(o.parent()[0].scrollWidth).css("top",-1*(o.height()+(is_ie7?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),$(function(){var css_string=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";is_ff2&&(css_string+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } "),(is_ie7||is_ie6)&&(css_string+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } "),$.vakata.css.add_sheet({str:css_string,title:"jstree"})})}(jQuery),function($){var nodeInterface=["getChildren","getChildrenCount","getAttr","getName","getProps"],validateInterface=function(obj,inter){var valid=!0;return obj=obj||{},inter=[].concat(inter),$.each(inter,function(i,v){return $.isFunction(obj[v])?void 0:(valid=!1,!1)}),valid};$.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(n,b){var obj=-1==n?this._get_settings().model.object:n.data("jstree_model");return validateInterface(obj,nodeInterface)?void(this._get_settings().model.async?obj.getChildren($.proxy(function(data){this.model_done(data,b)},this)):this.model_done(obj.getChildren(),b)):b.call(null,!1)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(data,callback){var ret=[],s=this._get_settings(),_this=this;$.isArray(data)||(data=[data]),$.each(data,function(i,nd){var r=nd.getProps()||{};r.attr=nd.getAttr()||{},nd.getChildrenCount()&&(r.state="closed"),r.data=nd.getName(),$.isArray(r.data)||(r.data=[r.data]),_this.data.types&&$.isFunction(nd.getType)&&(r.attr[s.types.type_attr]=nd.getType()),r.attr.id&&s.model.id_prefix&&(r.attr.id=s.model.id_prefix+r.attr.id),r.metadata||(r.metadata={}),r.metadata.jstree_model=nd,ret.push(r)}),callback.call(null,ret)}}})}(jQuery)}}();